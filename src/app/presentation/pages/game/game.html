<section class="game">
  <header class="game__header">
    <app-score-board
      [playerName]="gameState().playerName"
      [points]="gameState().points"
    ></app-score-board>

    @if (gameState().isTimeBased && gameState().timeRemaining !== undefined) {
    <span
      class="game__timer"
      [class.game__timer--low]="gameState().timeRemaining! <= gameConfig.lowTimeThreshold"
      i18n="@@game.timer.label"
    >
      Tiempo: {{ gameState().timeRemaining }}s
    </span>
    }

    <div class="game__header-controls">
      <img
        src="icons/fire-full.svg"
        alt="Dificultad"
        class="game__icon"
        aria-hidden="true"
      />
      <select
        class="game__select"
        [value]="gameState().difficulty.id"
        (change)="onDifficultyChange($event)"
      >
        @for (difficulty of difficulties; track difficulty.id) {
        <option [value]="difficulty.id">{{ difficulty.label }}</option>
        }
      </select>
      <button
        type="button"
        class="game__play"
        (click)="onRestart()"
        i18n="@@game.play.button"
      >
        Play & Restart
      </button>
    </div>
  </header>

  @if (isGameStarted()) {
  <app-game-board
    [holes]="holes"
    [onHit]="handleHit"
    [activeMoleIndexes]="activeMoleIndexes()"
  ></app-game-board>
  }

  <div class="game__footer-bottom">
    <button
      type="button"
      class="game__exit"
      (click)="onChangePlayer()"
      i18n="@@game.exit.button"
    >
      Salir
    </button>
  </div>

  @if (showGameOver()) {
  <div
    class="game__overlay"
    (click)="onCloseGameOver()"
    (keydown.enter)="onCloseGameOver()"
    (keydown.space)="onCloseGameOver()"
    tabindex="0"
    role="button"
    aria-label="Cerrar modal"
  >
    <div
      class="game__modal"
      (click)="$event.stopPropagation()"
      (keydown.enter)="$event.stopPropagation()"
      (keydown.space)="$event.stopPropagation()"
      tabindex="0"
      role="dialog"
      aria-label="GAME OVER"
    >
      <h2 class="game__modal-title" i18n="@@game.gameOver.title">GAME OVER</h2>
      <p class="game__modal-score" i18n="@@game.gameOver.score">
        Puntuaci√≥n: {{ finalScore() }}
      </p>
      <button
        type="button"
        class="game__modal-button"
        (click)="onCloseGameOver()"
        i18n="@@game.gameOver.close"
      >
        Cerrar
      </button>
    </div>
  </div>
  }
</section>
